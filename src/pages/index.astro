---
import Layout from '../layouts/Layout.astro';

// Načtení všech markdown souborů ze složky projects
const allProjects = await Astro.glob('../projects/*.md');

// Seřazení podle "order"
const projects = allProjects.sort((a, b) => a.frontmatter.order - b.frontmatter.order);
---

<Layout title="Moje Projekty">
	<h1>Moje Portfolio</h1>
    <p>Vítejte. Tady odkládám věci, které jsem vytvořil, aby mi usnadnily život.</p>
    <hr style="border-color: #333; margin: 2rem 0;">

    {projects.map((project) => (
        <div class="project-card">
            <h2>{project.frontmatter.title}</h2>
            <p><strong>{project.frontmatter.description}</strong></p>
            
            <div class="content-body">
                <project.Content />
            </div>

            {/* Zobrazení obrázku (pokud existuje) */}
            {project.frontmatter.image && (
                <div class="project-image-container">
                    <img 
                        src={project.frontmatter.image} 
                        alt={`Náhled ${project.frontmatter.title}`} 
                        loading="lazy"
                    />
                </div>
            )}

            <div class="tech-stack">Technologie: {project.frontmatter.tech}</div>

            {/* Zobrazení tlačítka s odkazem (pokud existuje) */}
            {project.frontmatter.link && (
                <div class="links">
                    <a href={project.frontmatter.link} target="_blank" class="btn">
                        Podívat se na projekt →
                    </a>
                </div>
            )}

        </div>
    ))}
</Layout>

<style>
    .content-body {
        margin-top: 1rem;
        color: #b0b0b0;
    }
    .content-body :global(strong) {
        color: white;
    }
    .content-body :global(ul) {
        padding-left: 1.5rem;
    }

    /* Styly pro obrázky */
    .project-image-container {
        margin-top: 1.5rem;
        border-radius: 8px;
        overflow: hidden;
        border: 1px solid #333;
    }
    .project-image-container img {
        width: 100%;
        height: auto;
        display: block;
        object-fit: cover;
    }

    /* Styly pro tlačítka */
    .links {
        margin-top: 1.5rem;
    }
    .btn {
        background: #333;
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 4px;
        text-decoration: none;
        font-weight: bold;
        border: 1px solid #555;
        transition: background 0.2s;
        display: inline-block;
    }
    .btn:hover {
        background: #555;
    }
</style>